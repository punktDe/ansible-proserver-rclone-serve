{% macro rclone(rclone_serve_config_name, rclone_serve_config, rclone_serve_defaults) -%}
{{ rclone_serve_config.rclone|default(rclone_serve_defaults.rclone, true) }} serve {{ rclone_serve_config.type }}{% if rclone_serve_config.users|default(none) != none %} --htpasswd={{ rclone_serve.prefix.config|quote }}/{{ rclone_serve_config_name|quote }}.htpasswd{% endif %}{% for option, value in (rclone_serve_config.opts|default({})).items()|selectattr('1', 'ne', none) %} --{{ option|quote }}={{ value|quote }}{% endfor %}{% for argument in ((rclone_serve_config.args|default({})).items()|sort(attribute='0'))|map(attribute='1')|select('ne', none) %} {{ argument|quote }}{% endfor %}
{%- endmacro %}
